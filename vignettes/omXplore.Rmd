---
title: "omXplore user manual"
author: 
- name: Samuel Wieczorek
- name: Thomas Burger
package: omXplore
abstract: >
    The package omXplore is a R package which provides functions to vizualize quantitative data from label-free proteomics experiments. It can deal with common data formats in Bioconductor such as MSnSet, MultiAssayEperiments, QFeatures or even simple lists. This document covers the functionalities available in `r BiocStyle::pkg_ver('omXplore')`.
date: "`r Sys.Date()`"
output:
    BiocStyle::html_document:
        highlight: tango
        number_sections: yes
        toc: true
        toc_depth: 2
        fig_width: 7
        fig_height: 6
        fig_caption: true
vignette: >
    %\VignetteIndexEntry{omXplore user Manual}
    %%\VignetteKeywords{Softmware, Mass Spectrometry, Quantitative }
    %\VignetteEncoding{UTF-8}
    %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Introduction

The `omXplore` package is a Shiny app which is a standalone hub for
plots dedicated to the analysis of proteomics data. It is compliant with
common data structures in Bioconductor such as `MSnSet`, `QFeatures` nor
`MultiAssayExperiments`.

`omXplore` has a user-friendly Shiny interface which has a series of
built-in plots. With less effort, it can also easily integrate new plots
(written as Shiny modules) from other packages or directly in the R
environment.

It contains:

-   several built-in plots,

-   one main UI which gives easily access to the individual plots.

All the plots in this package are based on Shiny technology
(\url{http://shiny.rstudio.com/}) and are implemented as modules. Thus,
they can also be run standalone or easily inserted in another Shiny app.

In that sense, the plots in `omXplore` can be used alone or as a
complement to the numerous packages on Bioconductor
(\url{https://www.bioconductor.org/}) it is compliant with. For example,
it is well suited for the package `Prostar`
(\url{https://www.bioconductor.org/packages/release/bioc/html/Prostar.html}) 
in which it is used.

One main feature is the capacity to insert plots (as shiny modules) from third party packages.

```{r load_pkg}
library(omXplore)
```

# omXplore data format

`omXplore` is based on the class `MultiAssayExperiments`
(\url{https://www.bioconductor.org/packages/release/bioc/html/MultiAssayExperiment.html})
and enrich it with specific slots needed to create built-in plots.
The plots display statistical information about data contained in the SummarizedExperiment
slots of a dataset.

Some items are added to the metadata of the instance of
MultiAssayExperiment and to each of the instances of
SummarizedExperiment.

#### Additional info in MultiAssayExperiment

Currently, there is no custom slot in the metadata of the mae contains
the following additional items:

#### Additional info in SummarizedExperiment


The metadata of each SummarizedExperiment dataset contains the following
items:

-   **proteinID**: The name of the column which contains xxx

-   **colID**: The name of the column which serves as unique index

-   **cc**: The list of Connected Components, based on the adjacency
    matrix

-   **type**: The type of data contains in this object (e.g. peptide,
    protein, ...)

-   **pkg_version**: The name and version number which has been used to
    create this object


The **adjacencyMatrix** (when exists) is stored as a DataFrame in the
rowData() of a SUmmarizedexperiment item.

Thus, while the class used in common, it is necessary to "convert" the datasets to
the format used in `omXplore`. This process simply tries to find and extract information to
save them in the correct item of the slot metadata.


# Using omXplore

The package `omXplore` offers a collection of standard plots written as Shiny modules.
The main app is a Shiny module itself which displays the plots of each
module.

## Main UI

The main shiny app is called view_dataset(). It is launched as follows:

```{r view_dataset_modal, include=FALSE}
library(omXplore)
data(sub_R25)
view_dataset(sub_R25)
```

The resulting UI is the following:

```{r view_dataset_png, results='markup', fig.cap="`omXplore` interactive interface: xxxx.", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/view_dataset.png", error = FALSE)
```

The UI is divided in two parts. 
On the left side, a selection widget to select one of the SummarizedExperiment data contained in the dataset.
On the top of the right, a series of clickable vignettes which represent the different plots available. When the user clicks on one of those vignettes, the corresponding plot is showed below. is dedicated to the display of data. The selection of the plot to show
is possible by clicking one of the vignettes shown at the top of the window. The plot is then displayed with
two possible ways, whether the option used to launch the function `view_dataset()`: the plot can be shown in the same window as the UI (below the vignettes) or in a modal window.

```{r view_dataset_modal_png, results='markup', fig.cap="`omXplore` interactive interface with modal.", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/view_dataset_modal.png", error = FALSE)
```

```{r view_dataset_nomodal_png, results='markup', fig.cap="`omXplore` interactive interface without modal.", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/view_dataset_nomodal.png", error = FALSE)
```

When a plot is displayed, it shows the data corresponding to the dataset
selected in the widget (of the left side). If this dataset is changed, the plot is 
automatically updated with the data of the new dataset.

The list of vignettes is composed of:
- built-in shiny apps in the package `omXplore`. See details with `listPlotsModules()`,
- external apps which are exported by other packages. For more details on the
development of an external app, see section xxx.

## Individual plots

Each of the built-in plots can be run in a standalone mode rather than
embedded in the main UI. It is also possible to insert a module plot in
a third party Shiny app.

It is possible simply by running its name. The list of all shiny apps
which are available via omXplore can be seen using

```{r listShinyApps}
listShinyApps()
```



```{r vignettes_png, results='markup', fig.cap="`omXplore` interactive interface: xxxx.", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/plot_vignettes.png", error = FALSE)
```


See the help page of this function fore more details.

```{r ex_modules}
#data(sub_R25)
#omXplore_density(sub_R25, 1)
```

The resulting plot is the following:
```{r omXplore_density_png, results='markup', fig.cap="Plot generated by the module omXplore_density()", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/omXplore_density.png", error = FALSE)
```


# Adding external plots

omXplore can plot plots coming from third packages. For that purpose, two points may be considered:

-   make a shiny app available in the global R environment

-   ensure that the name of the two functions `ui()` and `server()` of
    the app respect a predefined syntax. More specifically, the name of
    the shiny app is composed by the prefix 'mod_ds\_' (which stands for
    'descriptive statistics') and a user-defined name. As for each Shiny
    app, there must be two functions (one for the ui part and the second
    one for the server part.). Thus, in this example, the shiny app
    called `foo` must provide the functions `foo_ui()` and
    `foo_server()`.

In this case, a clickable button is added to the series of vignettes (at the top of the right side
of the UI). If an image has been correctly configured, it is shown in this button.

The use of those external apps is devoted to its developer, the
interface of `omXplore` is only a shell that presents apps in a
user-friendly interface.

To add external app to `omXplore`, please use the global function
`view_dataset()` as follows. In the example below, one want to add the
app called `extFoo1` and `extFoo2` from the package `omXplore`. It is
only for the example, this app contains a simple plot just to
demonstrate how it works

```         
#data(vdata)
#addons <- list(omXplore = c("extFoo1", "extFoo2"))
#view_dataset(vdata, addons)
```

If there are icons to display within omXplore, the png images must be
stored in the 'images' directory of the corresponding package.

## Technical point of view

# Session information

```{r}
sessionInfo()
```
