---
title: "omXplore user manual"
author: 
- name: Samuel Wieczorek
- name: Thomas Burger
package: omXplore
abstract: >
    The package omXplore is a R package which provides functions to vizualize quantitative data from label-free proteomics experiments. It can deal with common data formats in Bioconductor such as MSnSet, MultiAssayEperiments, QFeatures or even simple lists. This document covers the functionalities available in `r BiocStyle::pkg_ver('omXplore')`.
date: "`r Sys.Date()`"
output:
    BiocStyle::html_document:
        highlight: tango
        number_sections: yes
        toc: true
        toc_depth: 2
        fig_width: 7
        fig_height: 6
        fig_caption: true
vignette: >
    %\VignetteIndexEntry{omXplore user Manual}
    %%\VignetteKeywords{Softmware, Mass Spectrometry, Quantitative }
    %\VignetteEncoding{UTF-8}
    %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Introduction

The `omXplore` package is a Shiny app which is a standalone hub for
plots dedicated to the analysis of proteomics data. It is compliant with
common data structures in Bioconductor such as `MSnSet`, `QFeatures` nor
`MultiAssayExperiments`.

`omXplore` has a user-friendly Shiny interface which has a series of
built-in plots. With less effort, it can also easily integrate new plots
(written as Shiny modules) from other packages or directly in the R
environment.

It contains:

-   several built-in plots,

-   one main UI which gives easily access to the individual plots.

All the plots in this package are based on Shiny technology
(\url{http://shiny.rstudio.com/}) and are implemented as modules. Thus,
they can be run standalone or easily inserted in another Shiny app.

In that sense, the plots in `omXplore` can be used alone or as a
complement to the numerous packages on Bioconductor
(\url{https://www.bioconductor.org/}) it is compliant with. For example,
it is well used in `Prostar`
(\url{https://www.bioconductor.org/packages/release/bioc/html/Prostar.html}).
The datasets contained in the experiment packages `DAPARdata` and
`DaparToolshedData` can be used as toy examples.

The package `omXplore` contains built-in plots but have the capability
to show plots developed by other developer (as a Shiny app).

```{r loagPkg}
library(omXplore)
```

# omXplore data format

`omXplore` is based on the class `MultiAssayExperiments`
(\url{https://www.bioconductor.org/packages/release/bioc/html/MultiAssayExperiment.html})
and enrich it with specific slots needed to create built-in plots.

Some items are added to the metadata of the instance of
MultiAssayExperiment and to each of the instances of
SummarizedExperiment.

#### Additional info in MultiAssayExperiment

Currently, there is no custom slot in the metadata of the mae contains
the following additional items:

#### Additional info in SummarizedExperiment

The **adjacencyMatrix** (when exists) is stored as a DataFrame in the
rowData() of the se.

The metadata of each SummarizedExperiment dataset contains the following
items:

-   **proteinID**: The name of the column which contains xxx

-   **colID**: The name of the column which serves as unique index

-   **cc**: The list of Connected Components, based on the adjacency
    matrix

-   **type**: The type of data contains in this object (e.g. peptide,
    protein, ...)

-   **pkg_version**: The name and version number which has been used to
    create this object

To convert datasets to the enriched MultiAssayExperiment, run the
function \`convert_to_mae()\` as follows:

```{r convert_to_mae}
data("Exp1_R25_pept", package = 'DAPARdata')
sub_R25_pept <- convert_to_mae(Exp1_R25_pept[150:170])
```

# Using omXplore

`omXplore` is a collection of standard plots written as Shiny modules.
The main app is also a Shiny module which displays the plots of each
module.

## Main UI

The main shiny app called view_dataset() is the main application of the
package `omXplore`. It can be launched as follows:

```{r view_dataset_modal, include=FALSE}
library(shiny)
library(omXplore)
data(sub_R25_prot)
view_dataset(sub_R25_prot)
```

\` The resulting UI is the following:

```{r view_dataset_png, results='markup', fig.cap="`omXplore` interactive interface: xxxx.", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/view_dataset.png", error = FALSE)
```

The vignettes for the plots are buttons on which the user an click to
display the corresponding plot Whether the use of modal window has been
selected, the new plot is shown in the same window as the UI (below the
vignettes) or in a modal window.

```{r view_dataset_modal_png, results='markup', fig.cap="`omXplore` interactive interface: xxxx.", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/view_dataset_modal.png", error = FALSE)
```

```{r view_dataset_nomodal_png, results='markup', fig.cap="`omXplore` interactive interface: xxxx.", echo=FALSE, out.width='100%', fig.align='center', fig.wide = TRUE}
knitr::include_graphics("./figs/view_dataset_nomodal.png", error = FALSE)
```

It is composed of two parts : \* a selection widget to select the
dataset to show in the plots, \* a graphical part with clickable
vignettes which represent the plots available. When the user clicks on
one of those vignettes, the corresponding plot is showed below.

When a plot is displayed, it shows the data corresponding to the dataset
selected in the widget. If this dataset is changed, the plot update
automatically to the new dataset.

The list of vignettes is composed of : \* built-in shiny apps in the
package `omXplore`. See details with `listPlotsModules()`. \* external
apps which are exported by other packages. For more details on the
development of an external app, see section xxx.

## Individual plots

Each of the built-in plots can be run in a standalone mode rather than
embedded in the main UI. It is also possible to insert a module plot in
a third party Shiny app.

It is possible simply by running its name. The list of all shiny apps
which are available via omXplore can be seen using

```{r listShinyApps}
listShinyApps()
```

See the help page of this function fore more details.

```{r ex_modules}
#data(vdata)
#obj <- vdata[[1]]
#listPlotModules()
#omXplore_pca(obj)
#omXplore_density(obj)
```

# Adding external plots

omXplore can plot builtin plots as external shiny app.

For that purpose, two points may be considered:

-   make a shiny app available in the global R environment

-   ensure that the name of the two functions `ui()` and `server()` of
    the app respect a predefined syntax. More specifically, the name of
    the shiny app is composed by the prefix 'mod_ds\_' (which stands for
    'descriptive statistics') and a user-defined name. As for each Shiny
    app, there must be two functions (one for the ui part and the second
    one for the server part.). Thus, in this example, the shiny app
    called `foo` must provide the functions `foo_ui()` and
    `foo_server()`.

The use of those external apps is devoted to its developer, the
interface of `omXplore` is only a shell that presents apps in a
user-friendly interface.

To add external app to `omXplore`, please use the global function
`view_dataset()` as follows. In the example below, one want to add the
app called `extFoo1` and `extFoo2` from the package `omXplore`. It is
only for the example, this app contains a simple plot just to
demonstrate how it works

```         
#data(vdata)
#addons <- list(omXplore = c("extFoo1", "extFoo2"))
#view_dataset(vdata, addons)
```

If there are icons to display within omXplore, the png images must be
stored in the 'images' directory of the corresponding package.

## Technical point of view

# Session information

```{r}
sessionInfo()
```
