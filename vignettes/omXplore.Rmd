---
title: "omXplore user manual"
author: 
- name: Samuel Wieczorek
- name: Thomas Burger
package: omXplore
abstract: >
    The package omXplore is a R package which provides functions to vizualize quantitative data from label-free proteomics experiments. It can deal with several data formats such as MSnSet, QFeatures or event simple lists. This document covers the functionalities available in `r BiocStyle::pkg_ver('omXplore')`.
date: "`r Sys.Date()`"
output:
    BiocStyle::html_document:
        highlight: tango
        number_sections: yes
        toc: true
        toc_depth: 2
vignette: >
    %\VignetteIndexEntry{omXplore user Manual}
    %\VignetteEngine{knitr::rmarkdown}
    %%\VignetteKeywords{Softmware, Mass Spectrometry, Quantitative }
    %\VignetteEncoding{UTF-8}
---

\newcommand{\shellcmd}[1]{\\\indent\indent\texttt{\footnotesize\# #1}}

\newcommand{\Rcmd}[1]{\\\indent\indent\texttt{\footnotesize\# #1}}

\newcommand{\bordurefigure}[1]{\fbox{\includegraphics{#1}}}



# Introduction

The `omXplore` package is a Shiny app which is a standalone hub for plots
dedicated to the analysis of proteomics data. It is compliant with two data 
formats: `MSnSet` and `QFeatures`. 

`omXplore` a series of built-in plots and can easily integrate other plots that 
comes from other packages or directly developed in R.

It contains:
* several built-in plots,
* one main UI which gives easily access to the individual plots.

All the plots in this package are based on Shiny technology 
(\url{http://shiny.rstudio.com/}) and are implemented as modules modules
(\url{https://rviews.rstudio.com/2021/10/20/a-beginner-s-guide-to-shiny-modules/}). Thus, each plot can be run standalone or easily inserted in another Shiny app.
In that sense, the plots in `omXplore` can be used alone or as a complement to 
the numerous packages on Bioconductor (\url{https://www.bioconductor.org/}) it is compliant with. For example, it is well used in `Prostar` (Proteomics statistical analysis with R) which is a 
web interface based on Shiny technology (\url{http://shiny.rstudio.com/}) which
provides GUI (Graphical User Interfaces).
The datasets contained in the experiment packages `DAPARdata` and `DaparToolshedData` can be used as toy examples.

`omXplore` contains built-in plots but have the capability to show plots developed by other developer (as a Shiny app).

```{r loagPkg, warning = FALSE, message = FALSE, echo = TRUE}
library(omXplore)
```

# omXplore data format

`omXplore` is based on its own data format (a S4 class named `VizData`) which is a 
simplification of the formats it can deal with. The main data structure in the
package `omXplore` is a list of instances of `VizData` objects called `VizList`.

The classes `VizList` and `VizData` have both common features with structures datasets
such as `MultiArrayExperiment`, `QFeatures` or `MSnSet`.
One could ask why do not use one of these existing classes? There is one main reason 
to this. 

The calls to the function plots are generated dynamically from functions available
in the R Global environment. One need to pass the same argument to these functions,
thus this argument should contain all the information needed for all plots.

the disadvantage of this approach is the existence of redundant information betwween
the different VizData objects in an instance of VizList.

However, if one has used formats like MultiAssayExperiment, one might have been
forced to pass the entire dataset to a simple plot to guarantee to have the 
parameters needed (e.g. the names of the conditions for each sample).

To see which data formats `omXplore` can manage, run 

```{r FormatAvailables,  message = FALSE, warning = FALSE, echo = TRUE}
omXplore::FormatAvailables()
```

To convert datasets to the class omXplore-class, run

```{r convert2Viz, message = FALSE, warning = FALSE, echo = TRUE}
#data(sub_Exp1_R2_prot_qf)
#convert2VizList(sub_Exp1_R2_prot_qf)
```


## VizData class

The internal data structures in omXplore reproduce the same logics as for
the class MultiAssayExperiment. For simplicity and genericity, it is not
an derivated classes but new classes but using common ideas.
Thus, omXplore consist in two classes:

* the class VizData which contains. This class is similar to the class 
'SummarizedExperiment'


* the class VizList which contains a list of instances of omXplore classes. This class is similar to the class 'MultiAssayExperiment'.


Summary of slots


The slots of the class 'omXplore' are:
* xxx
* xxx
* xxx
* xxx
* xxx
* xxx
* xxx

However, all the plots functions in `omXplore` integrate a convert feature 
so as to pass directly datasets in other format to the plot functions. They
also have a check function to ensure that the parameters are in the correct
format.



# Using omXplore

`omXplore` is a collection of standard plots which are available as Shiny applications. Thus, each plot has its own application.

The main feature in `omXplore` is a Shiny app which combine all the different Shiny app.

## Main UI

The Shiny app called view_dataset() is the main application of the package
`omXplore`. It can be lauched as follows:


```{r view_dataset, eval=FALSE, fig.show='hide', message = FALSE, warning = FALSE, echo = TRUE}
#data(vData_ft)
#view_dataset(vData_ft)
```

It is composed of two parts :
* a selection widget to select the dataset to show in the plots,
* a graphical part with clickable vignettes which represent the plots 
available. When the user clicks on one of those vignettes, the corresponding 
plot is showed below.

When a plot is displayed, it shows the data corresponding to the dataset 
selected in the widget. If this dataset is changed, the plot update 
automatically to the new dataset.


The list of vignettes is composed of :
* built-in shiny apps in the package `omXplore`. See details with 
`listPlotsModules()`.
* external apps which are exported by other packages. For more details on the
development of an external app, see section xxx.






## Individual plots

Each of the built-in plots can be run in a standalone mode rather than embedded 
in the main UI.

It is possible simply by running its name. The list of all shiny apps which are 
available via omXplore can be seen using

```{r listShinyApps, eval = TRUE, message = FALSE, warning = FALSE, echo = TRUE}
listShinyApps()
```
See the help page of this function fore more details.


```{r ex_modules, eval = FALSE, fig.show='hide', message = FALSE, warning = FALSE, echo = TRUE}
#data(vData_ft)
#obj <- vData_ft[[1]]
#listPlotModules()
#omXplore_pca(obj)
#omXplore_density(obj)
```

# Adding external plots

omXplore can plot builtin plots as external shiny app. For that purpose, there 
are only two points to consider:
* make a shiny app available in the global R environment
* ensure that the name of the two functions `ui()` and `server()` of the app 
respect a predefined syntax. More specifically, the name of the shiny app is 
composed by the prefix 'mod_ds_' (which stands for 'descriptive statistics') and 
a user-defined name. As for each Shiny app, there must be two functions (one 
for the ui part and the second one for the server part.).
Thus, in this example, the shiny app called `foo` must provide the functions 
`foo_ui()` and `foo_server()`. 


The use of those external apps is devoted to its developer, the interface of 
omXplore is only a shell that presents apps in a user-friendly interface.

To add external app to omXplore, please use the global function `view_dataset()`
as follows. In the example below, one want to add the app called `extFoo1` and 
`extFoo2` from the package `omXplore`. It is only for the example, this app 
contains a simple plot just to demonstrate how it works

```
#data(vData_ft)
#addons <- list(omXplore = c("extFoo1", "extFoo2"))
#view_dataset(vData_ft, addons)
```


If there are icons to display within omXplore, the png images must be stored in
the 'images' directory of the corresponding package.


## Technical point of view



# Session information

```{r}
sessionInfo()
```
